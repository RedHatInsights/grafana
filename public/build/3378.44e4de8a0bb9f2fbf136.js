"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3378],{"./public/app/features/alerting/unified/components/alert-groups/MatcherFilter.tsx":(e,a,t)=>{t.d(a,{F:()=>o});t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js");var n,s,r=t("./packages/grafana-ui/src/index.ts"),i=t("./.yarn/__virtual__/@emotion-css-virtual-9fd25d72e0/0/cache/@emotion-css-npm-11.1.3-72aa05c30f-dc50283f65.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),l=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/jsx-runtime.js");const o=e=>{let{className:a,onFilterChange:t,queryString:i}=e;const o=(0,r.useStyles2)(c),u=n||(n=(0,l.jsx)(r.Icon,{name:"search"}));return(0,l.jsxs)("div",{className:a,children:[(0,l.jsxs)(r.Label,{children:[(0,l.jsx)(r.Tooltip,{content:s||(s=(0,l.jsxs)("div",{children:["Filter alerts using label querying, ex:",(0,l.jsx)("pre",{children:'{severity="critical", instance=~"cluster-us-.+"}'})]})),children:(0,l.jsx)(r.Icon,{className:o.icon,name:"info-circle",size:"xs"})}),"Search by label"]}),(0,l.jsx)(r.Input,{placeholder:"Search",defaultValue:i,onChange:e=>{const a=e.target;t(a.value)},"data-testid":"search-query-input",prefix:u,className:o.inputWidth})]})},c=e=>({icon:i.css`
    margin-right: ${e.spacing(.5)};
  `,inputWidth:i.css`
    width: 340px;
    flex-grow: 0;
  `})},"./public/app/features/alerting/unified/components/rules/RuleDetailsActionButtons.tsx":(e,a,t)=>{t.d(a,{f:()=>y});var n,s,r=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js"),i=t("./.yarn/__virtual__/react-redux-virtual-8e30c710ae/0/cache/react-redux-npm-7.2.5-cf7e365145-04ac4a4178.zip/node_modules/react-redux/es/index.js"),l=t("./.yarn/__virtual__/react-router-virtual-31642fe47a/0/cache/react-router-npm-5.2.1-ea754d7473-7daae084bf.zip/node_modules/react-router/esm/react-router.js"),o=t("./.yarn/__virtual__/@emotion-css-virtual-9fd25d72e0/0/cache/@emotion-css-npm-11.1.3-72aa05c30f-dc50283f65.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),c=t("./packages/grafana-data/src/index.ts"),u=t("./packages/grafana-runtime/src/index.ts"),p=t("./packages/grafana-ui/src/index.ts"),d=t("./public/app/core/services/context_srv.ts"),m=t("./public/app/core/core.ts"),f=t("./public/app/features/alerting/unified/hooks/useIsRuleEditable.ts"),g=t("./public/app/features/alerting/unified/utils/constants.ts"),h=t("./public/app/features/alerting/unified/utils/datasource.ts"),x=t("./public/app/features/alerting/unified/utils/misc.ts"),b=t("./public/app/features/alerting/unified/utils/rule-id.ts"),j=t("./public/app/features/alerting/unified/state/actions.ts"),_=t("./public/app/features/alerting/unified/utils/alertmanager.ts"),v=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/jsx-runtime.js");const y=e=>{var a;let{rule:t,rulesSource:o}=e;const y=(0,i.useDispatch)(),z=(0,l.TH)(),w=(0,p.useStyles2)(S),{namespace:k,group:R,rulerRule:C}=t,[q,E]=(0,r.useState)(),$=(0,h.HY)(o)?o:null===(a=(0,_.Xy)(o.jsonData.alertmanagerUid))||void 0===a?void 0:a.name,N=[],D=[],{isEditable:F}=(0,f.M)((0,h.EG)(o),C),I=z.pathname+z.search,U=z.pathname.endsWith("/view");const M=()=>{if(q&&q.rulerRule){const e=b.Zk((0,h.EG)(q.namespace.rulesSource),q.namespace.name,q.group.name,q.rulerRule);y((0,j.hS)(e,{navigateTo:U?"/alerting/list":void 0})),E(void 0)}},L=()=>{if((0,h.jq)(o)){const e=`${encodeURIComponent(o.name)}/${encodeURIComponent(t.name)}`;return`${u.config.appUrl}${u.config.appSubUrl}/alerting/${e}/find`}return window.location.href.split("?")[0]};if((0,h.jq)(o)&&d.Vt.isEditor&&N.push((0,v.jsx)(p.LinkButton,{className:w.button,size:"xs",variant:"primary",icon:"chart-line",target:"__blank",href:(0,x.mH)(o.name,t.query),children:"See graph"},"explore")),t.annotations[g.q6.runbookURL]&&N.push((0,v.jsx)(p.LinkButton,{className:w.button,size:"xs",variant:"primary",icon:"book",target:"__blank",href:t.annotations[g.q6.runbookURL],children:"View runbook"},"runbook")),t.annotations[g.q6.dashboardUID]){const e=t.annotations[g.q6.dashboardUID];if(e){N.push((0,v.jsx)(p.LinkButton,{className:w.button,size:"xs",variant:"primary",icon:"apps",target:"__blank",href:`d/${encodeURIComponent(e)}`,children:"Go to dashboard"},"dashboard"));const a=t.annotations[g.q6.panelID];a&&N.push((0,v.jsx)(p.LinkButton,{className:w.button,size:"xs",variant:"primary",icon:"apps",target:"__blank",href:`d/${encodeURIComponent(e)}?viewPanel=${encodeURIComponent(a)}`,children:"Go to panel"},"panel"))}}if($&&N.push((0,v.jsx)(p.LinkButton,{className:w.button,size:"xs",icon:"bell-slash",target:"__blank",href:(0,x.S1)($,t),children:"Silence"},"silence")),U||D.push((0,v.jsx)(p.LinkButton,{className:w.button,size:"xs",variant:"secondary",icon:"eye",href:(0,x.V2)(o,t,I),children:"View"},"view")),F&&C){const e=(0,h.EG)(o),a=b.Zk(e,k.name,R.name,C),n=c.urlUtil.renderUrl(`${u.config.appSubUrl}/alerting/${encodeURIComponent(b.$V(a))}/edit`,{returnTo:I});U&&D.push((0,v.jsx)(p.ClipboardButton,{onClipboardCopy:()=>{m.h$.emit(c.AppEvents.alertSuccess,["URL copied!"])},onClipboardError:e=>{m.h$.emit(c.AppEvents.alertError,["Error while copying URL",e.text])},className:w.button,size:"sm",getText:L,children:"Copy link to rule"},"copy")),D.push((0,v.jsx)(p.LinkButton,{className:w.button,size:"xs",variant:"secondary",icon:"pen",href:n,children:"Edit"},"edit"),(0,v.jsx)(p.Button,{className:w.button,size:"xs",type:"button",variant:"secondary",icon:"trash-alt",onClick:()=>E(t),children:"Delete"},"delete"))}return N.length||D.length?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:w.wrapper,children:[(0,v.jsx)(p.HorizontalGroup,{width:"auto",children:N.length?N:n||(n=(0,v.jsx)("div",{}))}),(0,v.jsx)(p.HorizontalGroup,{width:"auto",children:D.length?D:s||(s=(0,v.jsx)("div",{}))})]}),!!q&&(0,v.jsx)(p.ConfirmModal,{isOpen:!0,title:"Delete rule",body:"Deleting this rule will permanently remove it from your alert rule list. Are you sure you want to delete this rule?",confirmText:"Yes, delete",icon:"exclamation-triangle",onConfirm:M,onDismiss:()=>E(void 0)})]}):null};const S=e=>({wrapper:o.css`
    padding: ${e.spacing(2)} 0;
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    flex-wrap: wrap;
    border-bottom: solid 1px ${e.colors.border.medium};
  `,button:o.css`
    height: 24px;
    margin-top: ${e.spacing(1)};
    font-size: ${e.typography.size.sm};
  `})},"./public/app/features/alerting/unified/components/rules/RuleDetailsAnnotations.tsx":(e,a,t)=>{t.d(a,{J:()=>l});t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js");var n=t("./.yarn/__virtual__/@emotion-css-virtual-9fd25d72e0/0/cache/@emotion-css-npm-11.1.3-72aa05c30f-dc50283f65.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),s=t("./packages/grafana-ui/src/index.ts"),r=t("./public/app/features/alerting/unified/components/AnnotationDetailsField.tsx"),i=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/jsx-runtime.js");function l(e){const{annotations:a}=e,t=(0,s.useStyles2)(o);return 0===a.length?null:(0,i.jsx)("div",{className:t.annotations,children:a.map((e=>{let[a,t]=e;return(0,i.jsx)(r.a,{annotationKey:a,value:t},a)}))})}const o=()=>({annotations:n.css`
    margin-top: 46px;
  `})},"./public/app/features/alerting/unified/components/rules/RuleDetailsDataSources.tsx":(e,a,t)=>{t.d(a,{C:()=>d});var n=t("./.yarn/__virtual__/@emotion-css-virtual-9fd25d72e0/0/cache/@emotion-css-npm-11.1.3-72aa05c30f-dc50283f65.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),s=t("./packages/grafana-runtime/src/index.ts"),r=t("./packages/grafana-ui/src/index.ts"),i=t("./public/app/features/expressions/ExpressionDatasource.ts"),l=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js"),o=t("./public/app/features/alerting/unified/utils/datasource.ts"),c=t("./public/app/features/alerting/unified/utils/rules.ts"),u=t("./public/app/features/alerting/unified/components/DetailsField.tsx"),p=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/jsx-runtime.js");function d(e){const{rulesSource:a,rule:t}=e,n=(0,r.useStyles2)(m),d=(0,l.useMemo)((()=>{if((0,o.jq)(a))return[{name:a.name,icon:a.meta.info.logos.small}];if((0,c.Pc)(t.rulerRule)){const{data:e}=t.rulerRule.grafana_alert,a=e.reduce(((e,a)=>{const t=(0,s.getDataSourceSrv)().getInstanceSettings(a.datasourceUid);return t&&t.uid!==i.Yq?(e[t.name]={name:t.name,icon:t.meta.info.logos.small},e):e}),{});return Object.values(a)}return[]}),[t,a]);return 0===d.length?null:(0,p.jsx)(u.C,{label:"Data source",children:d.map(((e,a)=>{let{name:t,icon:s}=e;return(0,p.jsxs)("div",{children:[s&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("img",{alt:`${t} datasource logo`,className:n.dataSourceIcon,src:s})," "]}),t]},t)}))})}function m(e){const a=e.spacing(2);return{dataSourceIcon:n.css`
      width: ${a};
      height: ${a};
    `}}},"./public/app/features/alerting/unified/components/rules/RuleDetailsExpression.tsx":(e,a,t)=>{t.d(a,{C:()=>x});var n=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js"),s=t("./.yarn/__virtual__/@emotion-css-virtual-9fd25d72e0/0/cache/@emotion-css-npm-11.1.3-72aa05c30f-dc50283f65.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),r=t("./public/app/features/alerting/unified/utils/datasource.ts"),i=t("./public/app/features/alerting/unified/components/DetailsField.tsx"),l=t("./.yarn/__virtual__/@grafana-slate-react-virtual-13c8a80c0a/0/cache/@grafana-slate-react-npm-0.22.10-grafana-510bc0576d-3417c53d9d.zip/node_modules/@grafana/slate-react/lib/slate-react.es.js"),o=t("./public/app/plugins/datasource/prometheus/promql.ts"),c=t("./public/app/plugins/datasource/loki/syntax.ts"),u=t("./.yarn/cache/prismjs-npm-1.25.0-8d60169ac0-04d8eae9d1.zip/node_modules/prismjs/prism.js"),p=t("./packages/grafana-ui/src/index.ts"),d=t("./public/app/features/alerting/unified/components/Well.tsx"),m=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/jsx-runtime.js");const f=e=>{let{language:a,expr:t}=e;const s=(0,n.useMemo)((()=>[(0,p.SlatePrism)({onlyIn:e=>"code_block"===e.type,getSyntax:()=>a},Object.assign({},u.languages,{[a]:"logql"===a?c.ZP:o.ZP}))]),[a]),r=(0,n.useMemo)((()=>(0,p.makeValue)(t)),[t]);return(0,m.jsx)(l.ML,{plugins:s,value:r,readOnly:!0})},g=e=>{let{expression:a,rulesSource:t}=e;const n=(0,p.useStyles)(h);return(0,m.jsx)(d.t,{className:(0,s.cx)(n.well,"slate-query-field"),children:(0,r.jq)(t)?(0,m.jsx)(f,{expr:a,language:t.type===r.ye.Loki?"logql":"promql"}):a})},h=e=>({well:s.css`
    font-family: ${e.typography.fontFamily.monospace};
  `});function x(e){const{annotations:a,rulesSource:t,rule:n}=e,l=b();return(0,r.jq)(t)?(0,m.jsx)(i.C,{label:"Expression",horizontal:!0,className:(0,s.cx)({[l.exprRow]:!!a.length}),children:(0,m.jsx)(g,{expression:n.query,rulesSource:t})}):null}const b=()=>({exprRow:s.css`
    margin-bottom: 46px;
  `})},"./public/app/features/alerting/unified/components/rules/RuleDetailsMatchingInstances.tsx":(e,a,t)=>{t.d(a,{M:()=>x});var n,s=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js"),r=t("./public/app/features/alerting/unified/utils/rules.ts"),i=t("./public/app/features/alerting/unified/components/DetailsField.tsx"),l=t("./public/app/features/alerting/unified/components/rules/AlertInstancesTable.tsx"),o=t("./public/app/plugins/panel/alertlist/types.ts"),c=t("./packages/grafana-ui/src/index.ts"),u=t("./.yarn/__virtual__/@emotion-css-virtual-9fd25d72e0/0/cache/@emotion-css-npm-11.1.3-72aa05c30f-dc50283f65.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),p=t("./public/app/features/alerting/unified/utils/alertmanager.ts"),d=t("./public/app/features/alerting/unified/utils/misc.ts"),m=t("./public/app/features/alerting/unified/components/alert-groups/MatcherFilter.tsx"),f=t("./public/app/types/unified-alerting-dto.ts"),g=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/jsx-runtime.js");const h=e=>{let{className:a,onStateFilterChange:t,stateFilter:s}=e;const r=Object.values(f.bj).map((e=>({label:e,value:e})));return(0,g.jsxs)("div",{className:a,children:[n||(n=(0,g.jsx)(c.Label,{children:"State"})),(0,g.jsx)(c.RadioButtonGroup,{options:r,value:s,onChange:t,onClick:e=>{e===s&&t(void 0)}})]})};function x(e){const{promRule:a}=e,[t,n]=(0,s.useState)(),[f,x]=(0,s.useState)(),[j]=(0,s.useState)(Math.floor(100*Math.random())),_=`queryString-${j}`,v=(0,c.useStyles)(b),y=(0,s.useMemo)((()=>{var e;return(0,r.x_)(a)&&null!==(e=a.alerts)&&void 0!==e&&e.length?function(e,a,t){let n=[...t];if(e){const a=(0,p.Zh)(e||"");n=n.filter((e=>{let{labels:t}=e;return(0,p.eD)(t,a)}))}a&&(n=n.filter((e=>e.state===a)));return n}(t,f,(0,d.Zl)(o.A.Importance,a.alerts)):[]}),[a,f,t]);return(0,r.x_)(a)?(0,g.jsxs)(i.C,{label:"Matching instances",horizontal:!0,children:[(0,g.jsx)("div",{className:(0,u.cx)(v.flexRow,v.spaceBetween),children:(0,g.jsxs)("div",{className:v.flexRow,children:[(0,g.jsx)(m.F,{className:v.rowChild,queryString:t,onFilterChange:e=>n(e)},_),(0,g.jsx)(h,{className:v.rowChild,stateFilter:f,onStateFilterChange:x})]})}),(0,g.jsx)(l.o,{instances:y})]}):null}const b=e=>({flexRow:u.css`
      display: flex;
      flex-direction: row;
      align-items: flex-end;
      width: 100%;
      flex-wrap: wrap;
      margin-bottom: ${e.spacing.sm};
    `,spaceBetween:u.css`
      justify-content: space-between;
    `,rowChild:u.css`
      margin-right: ${e.spacing.sm};
    `})},"./public/app/features/alerting/unified/components/rules/RuleHealth.tsx":(e,a,t)=>{t.d(a,{V:()=>o});var n,s,r=t("./.yarn/__virtual__/@emotion-css-virtual-9fd25d72e0/0/cache/@emotion-css-npm-11.1.3-72aa05c30f-dc50283f65.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),i=t("./packages/grafana-ui/src/index.ts"),l=(t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js"),t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/jsx-runtime.js"));const o=e=>{let{rule:a}=e;const t=(0,i.useStyles2)(c);return"err"===a.health||"error"===a.health?(0,l.jsx)(i.Tooltip,{theme:"error",content:a.lastError||"No error message provided.",children:(0,l.jsxs)("div",{className:t.warn,children:[n||(n=(0,l.jsx)(i.Icon,{name:"exclamation-triangle"})),s||(s=(0,l.jsx)("span",{children:"error"}))]})}):(0,l.jsx)(l.Fragment,{children:a.health})},c=e=>({warn:r.css`
    display: inline-flex;
    flex-direction: row;
    color: ${e.colors.warning.text};
    & > * + * {
      margin-left: ${e.spacing(1)};
    }
  `})},"./public/app/features/alerting/unified/components/rules/RuleState.tsx":(e,a,t)=>{t.d(a,{p:()=>m});var n,s,r=t("./.yarn/__virtual__/@emotion-css-virtual-9fd25d72e0/0/cache/@emotion-css-npm-11.1.3-72aa05c30f-dc50283f65.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),i=t("./packages/grafana-data/src/index.ts"),l=t("./packages/grafana-ui/src/index.ts"),o=t("./public/app/types/unified-alerting-dto.ts"),c=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js"),u=t("./public/app/features/alerting/unified/utils/rules.ts"),p=t("./public/app/features/alerting/unified/components/rules/AlertStateTag.tsx"),d=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/jsx-runtime.js");const m=e=>{let{rule:a,isDeleting:t,isCreating:r}=e;const m=(0,l.useStyles2)(f),{promRule:g}=a,h=(0,c.useMemo)((()=>{var e;if(g&&(0,u.x_)(g)&&null!==(e=g.alerts)&&void 0!==e&&e.length&&g.state!==o.x_.Inactive){const e=(0,u.ub)(g);if(e)return(0,d.jsxs)("span",{title:String(e),className:m.for,children:["for"," ",(0,i.intervalToAbbreviatedDurationString)({start:e,end:new Date},!1)]})}return null}),[g,m]);return t?n||(n=(0,d.jsxs)(l.HorizontalGroup,{align:"flex-start",children:[(0,d.jsx)(l.Spinner,{}),"deleting"]})):r?s||(s=(0,d.jsxs)(l.HorizontalGroup,{align:"flex-start",children:[" ",(0,d.jsx)(l.Spinner,{}),"creating"]})):g&&(0,u.x_)(g)?(0,d.jsxs)(l.HorizontalGroup,{align:"flex-start",children:[(0,d.jsx)(p.l,{state:g.state}),h]}):g&&(0,u.OP)(g)?(0,d.jsx)(d.Fragment,{children:"Recording rule"}):(0,d.jsx)(d.Fragment,{children:"n/a"})},f=e=>({for:r.css`
    font-size: ${e.typography.bodySmall.fontSize};
    color: ${e.colors.text.secondary};
    white-space: nowrap;
    padding-top: 2px;
  `})},"./public/app/features/alerting/unified/hooks/useCombinedRuleNamespaces.ts":(e,a,t)=>{t.d(a,{Z:()=>l});var n=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js"),s=t("./public/app/features/alerting/unified/utils/datasource.ts"),r=t("./public/app/features/alerting/unified/utils/rules.ts"),i=t("./public/app/features/alerting/unified/hooks/useUnifiedAlertingSelector.ts");function l(e){const a=(0,i._)((e=>e.promRules)),t=(0,i._)((e=>e.rulerRules)),l=(0,n.useRef)({}),c=(0,n.useMemo)((()=>{if(e){const a=(0,s.o_)(e);if(!a)throw new Error(`Unknown rules source: ${e}`);return[a]}return(0,s.h_)()}),[e]);return(0,n.useMemo)((()=>c.map((e=>{var n,i;const c=(0,s.jq)(e)?e.name:e,u=null===(n=a[c])||void 0===n?void 0:n.result,p=null===(i=t[c])||void 0===i?void 0:i.result,d=l.current[c];if(d&&d.promRules===u&&d.rulerRules===p)return d.result;const m={};Object.entries(p||{}).forEach((a=>{let[t,n]=a;const s={rulesSource:e,name:t,groups:[]};m[t]=s,function(e,a){e.groups=a.map((a=>{const t={name:a.name,interval:a.interval,rules:[]};return t.rules=a.rules.map((a=>function(e,a,t){return(0,r.cG)(e)?{name:e.alert,query:e.expr,labels:e.labels||{},annotations:e.annotations||{},rulerRule:e,namespace:a,group:t}:(0,r.yF)(e)?{name:e.record,query:e.expr,labels:e.labels||{},annotations:{},rulerRule:e,namespace:a,group:t}:{name:e.grafana_alert.title,query:"",labels:e.labels||{},annotations:e.annotations||{},rulerRule:e,namespace:a,group:t}}(a,e,t))),t}))}(s,n)})),null==u||u.forEach((a=>{let{name:t,groups:n}=a;!function(e,a){a.forEach((a=>{var t;let n=e.groups.find((e=>e.name===a.name));n||(n={name:a.name,rules:[]},e.groups.push(n)),(null!==(t=a.rules)&&void 0!==t?t:[]).forEach((a=>{const t=function(e,a,t){var n;if((0,s.HY)(t))return a.rules.find((a=>a.name===e.name));return null!==(n=a.rules.find((a=>!a.promRule&&o(a,e,!0))))&&void 0!==n?n:a.rules.find((a=>!a.promRule&&o(a,e,!1)))}(a,n,e.rulesSource);t?t.promRule=a:n.rules.push(function(e,a,t){return{name:e.name,query:e.query,labels:e.labels||{},annotations:(0,r.x_)(e)&&e.annotations||{},promRule:e,namespace:a,group:t}}(a,e,n))}))}))}(m[t]=m[t]||{rulesSource:e,name:t,groups:[]},n)}));const f=Object.values(m);return(0,s.HY)(e)&&f.forEach((e=>{e.groups=[{name:"default",rules:e.groups.flatMap((e=>e.rules)).sort(((e,a)=>e.name.localeCompare(a.name)))}]})),l.current[c]={promRules:u,rulerRules:p,result:f},f})).flat()),[a,t,c])}function o(e,a){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.name===a.name&&JSON.stringify([t?c(e.query):"",e.labels,e.annotations])===JSON.stringify([t?c(a.query):"",a.labels||{},(0,r.x_)(a)&&a.annotations||{}])}function c(e){return e.length>1&&"("===e[0]&&")"===e[e.length-1]&&(e=e.substr(1,e.length-2)),(e=e.replace(/\s|\n/g,"")).split("").sort().join("")}},"./public/app/features/alerting/unified/hooks/useFolder.ts":(e,a,t)=>{t.d(a,{W:()=>o});var n=t("./.yarn/__virtual__/react-redux-virtual-8e30c710ae/0/cache/react-redux-npm-7.2.5-cf7e365145-04ac4a4178.zip/node_modules/react-redux/es/index.js"),s=t("./public/app/features/alerting/unified/hooks/useUnifiedAlertingSelector.ts"),r=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js"),i=t("./public/app/features/alerting/unified/state/actions.ts"),l=t("./public/app/features/alerting/unified/utils/redux.ts");function o(e){const a=(0,n.useDispatch)(),t=(0,s._)((e=>e.folders));if((0,r.useEffect)((()=>{e&&a((0,i.sw)(e))}),[a,e]),e){const a=t[e]||l.oq;return{folder:a.result,loading:a.loading}}return{loading:!1}}},"./public/app/features/alerting/unified/hooks/useIsRuleEditable.ts":(e,a,t)=>{t.d(a,{M:()=>p});var n=t("./public/app/core/services/context_srv.ts"),s=t("./public/app/features/alerting/unified/utils/rules.ts"),r=t("./public/app/features/alerting/unified/hooks/useFolder.ts"),i=t("./public/app/features/alerting/unified/hooks/useUnifiedAlertingSelector.ts"),l=t("./.yarn/__virtual__/react-redux-virtual-8e30c710ae/0/cache/react-redux-npm-7.2.5-cf7e365145-04ac4a4178.zip/node_modules/react-redux/es/index.js"),o=t("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js"),c=t("./public/app/features/alerting/unified/state/actions.ts"),u=t("./public/app/features/alerting/unified/utils/datasource.ts");function p(e,a){var t,p;const d=(0,i._)((e=>e.lotexSupportsRuleEditing)),m=(0,l.useDispatch)(),f=a&&(0,s.Pc)(a)?a.grafana_alert.namespace_uid:void 0,{folder:g,loading:h}=(0,r.W)(f);if((0,o.useEffect)((()=>{void 0===d[e]&&e!==u.GC&&m((0,c.Yb)(e))}),[e,d,m]),!a)return{isEditable:!1,loading:!1};if((0,s.Pc)(a)){if(!f)throw new Error(`Rule ${a.grafana_alert.title} does not have a folder uid, cannot determine if it is editable.`);return{isEditable:null==g?void 0:g.canSave,loading:h}}return{isEditable:n.Vt.isEditor&&!(null===(t=d[e])||void 0===t||!t.result),loading:!(null===(p=d[e])||void 0===p||!p.loading)}}}}]);
//# sourceMappingURL=3378.44e4de8a0bb9f2fbf136.js.map